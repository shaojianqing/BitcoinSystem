package sjq.bitcoin.script;

import org.junit.Test;
import sjq.bitcoin.constant.Constants;
import sjq.bitcoin.message.TransactionMessage;
import sjq.bitcoin.message.data.TransactionOutput;
import sjq.bitcoin.service.data.LegacyAddress;
import sjq.bitcoin.utility.HexUtils;

import java.nio.ByteBuffer;
import java.util.List;

public class TestRawTransaction {

    private static final String rawTransactionData = "010000004c09fd698ad272c2c6aba75ea94538babf007568e1d47654e21c2c4ec1741838c6010000008a4730440220f56f67ba3a1c72371e805edb24e56c2cc2cef6d25801dcfe3b88c7069b816ba80220c606d61510bc334e113b1d6eedbdaa49e21a580648d5a3ea43f2e44e7c60a9a7014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff139dbaff890eee779d309d6f895331e4deb2ee6bb59fa5b7d456416e22c9718c010000008a473044022027ddafc6a16243407507a3ee7eb41be30f8822f8a2b47956662701ec136aaa75022096710153997991e396ef1ca99da99c4e2c7012615dca68cebda9c0f6a0e2c0ae014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff21e07b805237f1622341c1d8ab609a23c7efc85c6fd7bde1236c44cde9afdf63010000008a4730440220ea91b0433d4b03499114e3268b0ef43f46c8019dbb1ef8e59a12d6ceaba6f72c022073f1328a97a073e6d2e3d3ae80298591f3498b6f6c50c456fcca6ddbd1b09def014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffffc03604c6ccad13a185000049a136fb96e0e320512d5e47a287687f6558a15115010000008a4730440220493e590cc6026a6151240916a9667c13a6730389a3cbefa7a1b24dcb2aabdb810220bc6fc7314d7dfd88648790ed883f1b88f9381c95fe671eb7d8b7a4badd552c6b014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffffefc377bcf42c0d4a0da025486611f25a74f431de214e7e13db67589ac5b04a2c010000008a4730440220b9c60465f7d64d31888c096324b7ff8bb637151779695ac6a013ff7e7efd68500220be3d8f7ca7870d7639585860a57c02ac80f01075ad4d6756f47d45e72d7ff097014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffffc29320762663845c51853e663d891f92f7f4f997d5f7d280a6c7737a970a15bc580000008a473044022066f8a5551c98c8a5990ef322a1fde553d3d89e51031def99073eca4345019eaf0220b03257c1ff167314a0df6531cc297cd6104c55fa5cd6d2e3d2a7c8c474f02adc014104d88883e655d0804d21f4ce132cbfd55d01bb2970508fee5a96fb2c9d4100f4434c8d8bb5eeec3a0802e7cd6daf9ec0afaf29b5411aa49625de1ca541b0604cffffffffffe89490ce00dbe122eebf2c34ff85fc1c0bcb13165565ab3b62f774df7b030fed010000008a47304402202dd5808d5758841511152e9c34788d06a6ad46ea804d147743eb722dbba69b0b0220762c190587cb7f5edd006369971da82445185cc5c0dcf3b73b754a566273624c014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff9cd87273ae8c1e998653211080ccac83c2f0a54c6041076a25f2f098c50398b3010000008a4730440220f962e168e36f4fc49f96a59b18e1a00e24c427acc2ce97b08494047b40f903920220da3a97186da3c7394f41ad8fade6f0e6ed67ed976ef680b1a177407fc0edebf1014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff34f555cbbbe8a3b11c3fcb2db9443ec3ec8ed64af52d3ef688f7b0a35a9412cc010000008a47304402207c6a52367c0d38b27f0d857c86a3c14dff8d76b6b28d8ab2a384979f9d6ed7810220a4c6de0953150da1bd124f0a130c11ec9a9e16f04c3e50c7df8a5b5d9ef207dd014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becfffffffffa4c754dd01d3817f21dc9b9859313e6037cde449a4a3426431fefe4aa0d437e010000008a4730440220c2e74d9ca87f0285683c46fc0a379d4e696ec420642e8d4ee1d255d22d458ffc0220730a76538e14d8c3faf64e0645db55af48b12366cf29bb18f2cef05c887eb145014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffffec48739c0b1b7f5705b131b7c6904bc0964b7b6db4ab66fbe73444a1c2571890010000008a4730440220f4e4222bbb6446d03f4cc4e83b51b0226b7d11ad1b8f3d993f89ff9626dec9200220d7854e87bf8bb5d25ed8cf011211e0a45ad04d84669a75f60389731ed28501b1014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff613bcc5034382ddbad442c419055e86ce22878000ea5410823cdc3aa4a92eb94010000008a4730440220475f2651fb69dc9367b5514355f3e45e1d2d5d2aa606304657f0efa84caa0eec022057c45dff797fcc76976f40d93919f40f7abce0f69fb608f797fcebc39cebde74014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff02a4e530f46151c172bd3e1f01fb7fe1b2ec7dbedac1b8a55f0659c55538b378010000008a4730440220a909beddc514f66b162fb23878d29e74814dd0361e1ff374d3c6ab6447b8a7660220ff081554dc954f671bacbdf76291c3d6196086a575ae1b119b545ba9d24767d3014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffffbae09e5dd605e469c827e52626bb9a9558158bd935766adc1de942930fbcd413010000008a4730440220c8a7a78cc4181aa72b1014cd6f10740954a0a61a2890d20343e404aee0a8034d02208c4fec6d2510dd35e6686d60cb3bb7986de8c4327edd3d474e3459c71d01a524014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff474e619bd72450b934447d72fdba7cbeb2a4f4850ca8284c18c8bf0d501540a9010000008a4730440220f26299745f43dd4bd3b70214df4c9364f3b0a29d4a7192443c9acfaff29397160220a216a1612d7fe9dbb51e9f8185b62e9d489cdf9664e09e75212a7244073453a3014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffffe9a046c19c942faa2fcf182b614af9be07ab563a9511e4fe7d5f114d6a60d323010000008a4730440220a3bd29ac20c66bac9c6807a16ddb997a5dd5bbd143d0be9eec6828a41ae403b902208bc61ffa37337bb3653dec8c04021019bdcf481cd2a38e84ce0a94e65ef02859014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff87715f226ea2b2992a193121a8a983b3f2c9ac99692c5d8737ddf6aa9f439a0d000000008a47304402203f582bcfa6ff460022fa4ad051ea94a2a1d9bc9e7754f22bca1845e614a352570220e330c82b2a9f12728c1be79281e43a2141829d31016fb83aa7f96124ee8dd0ed0141044d3272a6d7aad87f3555b1d331446d52fe1c80e4735a835b7e67c7ea144b750c2a095b173564a4a2e7a6d8be15e65a6836336d06219c6f97a4174be149b67a7effffffff8a3e292bfdc553e378a65bf36e3c484649d4823137fa46c657584910e89f2a43010000008a4730440220b8a08de81db303cc7664a3e10925da1d81457867c73d7935a9938bc4c17cb8b40220632529316f73a2c743da1c84f41e72b6d9321defd939cbf1a347c5413896ff950141044d3272a6d7aad87f3555b1d331446d52fe1c80e4735a835b7e67c7ea144b750c2a095b173564a4a2e7a6d8be15e65a6836336d06219c6f97a4174be149b67a7effffffffc088c8c7ab8c0cdfa0e00f6dc2939ae0b635941f61e0644a4e150ab8763b53d1010000008a4730440220cfa897d82dc4df711e509b2ef2ddbfba3c97991305a969729de561fe19590b9f022089e7fb03be43adb3001576910ec435921a711ae447988bdc00ffaca78ff28a9a014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffffbe07f8f0b329f844ab4b04a9671594d408bb8e9a12bc0f1b6e864e91ea529dc5010000008a47304402202df840284f887dacfd2089b95e8aefa08135eb0dba488fe3cf3b24eeeb2333f40220bb152623be03c997486c0850c0f946093cc6059e6c31c504f7056f9e31cf0dd6014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff32ee73ef491dc07a4ff0d5123a7b07a40f9d6b65b5e1cd36c210cdbe4a65a982010000008a4730440220b567a61a2303ff14f31fda504e0910af2e6134397076349a1982b7400f425848022065ed8e507b4fa16779f5aa32362bf4d3e87c1e2498ff560e732590c079ee9227014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffffce9438c2bfe42badc589209f9deae1ea240d6a556b3b393ab8408e8a607c86af010000008a4730440220c226a946898d5897fa0e5bd0aba351fa6254848a00c9f9a49cb12ea8415d99320220cda9bdf84744cc92f04d9c92515afe9e5f6fc472247b716328f5c86c4ef79277014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff3802f21bc55204dcf50a9b3460354573d7bd07771d4253c5112bef7df5d706e4010000008a47304402201e3e3a45c5d2b69624cc60612a29056058ef02bdaa80009bf884e1c1a6adcfe802203ad88f9ca56584b08c07da794d711598086c16e2a1f67099206b4f3af8ad0e71014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffffa70910006c236a12d8d04e1c3cbb67f7c67a2f15ff27c72a6f1f31d61f115112010000008a47304402208b2e71bd3f19cc3a6f49ab9aeecaf3cfbe88b1d2950e9305d08f7b267e69c9c802206d1ec3adea755d9b9d5c25271aac5b36a64cb16bc781f8d2aabb65c71b0a191f014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffffc698640746ef8002612b545c2f265ed7d2eb1c273804dc6792850b3ff790c5d7010000008a47304402205d2043daf64a28b2eaae7584b6303a3ed85de79ac1112fbf5adc469e171b11750220099493154575a8e9170d2350ef623e58543be109adbba5d00e9b3e46992d579f014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becfffffffff1e0b0895f4393f4f79f73e5175fb4b7311398cf4307402f293cab9e72c9c396560000008a4730440220c313bbda599a7952a6f6696c13d5cffc3d463354fc44d4c2af5555de2348ef9d0220184b119a5bbcfd552f1e26934c85252bf14f8f8be0a483ab23d07c504923b4fa014104d88883e655d0804d21f4ce132cbfd55d01bb2970508fee5a96fb2c9d4100f4434c8d8bb5eeec3a0802e7cd6daf9ec0afaf29b5411aa49625de1ca541b0604cffffffffff7356ec164eb6547280aee387d160f8a590227c368a9e95d2213579194357a99a010000008a4730440220fd4b95271d78418425a4fdd017498b2e36f5acaa7875f6359b958dc3b8835ce30220853a25023f9f9a0daef13c5e8233fb7d58ba5bd5b419eb8cbf2db1f6eab450ad014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff3655182461ca43b6cad2b7f1ec068d80e8616b849717cb001a2adcafb239ed60010000008a473044022091b9e4ddf3858e480d5785cb74f992c03778c91388ed153ba067388c34b69c1102200baceb376689d5ff700b480c9ef12a2aefa0b7129910d6a3b58e094dfbb98b8c014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff425a19b262d22e7f04269b82ab1e2c7b11d81bfbb474260ffebb8363424746dd010000008a4730440220375ed8c4d1af0f43765f61d30501560a5dfe28c5307884693c6e9cd1dbafbb4b02208c239bb0aed7fdb4ab336a40f275fead88cd14329a1340acf55963d904aef420014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff3e7a9595a4178c90da6aa29d86ef9192673e5c8b091d1f6ccaca31e3dbe44120010000008a47304402206e7c4ea6668f1af0cee21daccf5a7f87a161bd42ed46166fc5e894abd47d94f60220bb79f5affb6515cb230645e14e7c2781472e5be4212b6debc5130125b79564a4014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffffb14947858428e54fbd71f95eb430de65068ccdc585b73bb61cc2ec64db91894d01000000894630430220954cd2d5e3959cdd95efce8db7da37e638aae12c2435d43b3e0ad79b371705f2021fad762086409e040f1f65197db520297a63e6595bdf686b5b9473f23e8c11a3014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffffe8bffe95166127ce62a9ab11fe41f6f10f6e97a655d1f0430259b68970f0d1f7010000008a4730440220ae034f7621e734f983035a2ce341f857c0b7788744579ce773f0aa880219d97002201c5ca90148f797f4f830e544a90e524ad7b9c19ea8e73985e89171d7d2362468014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff7f9192f6e90acc26aaaaf50023531b1ac68aa823f72f5e54dc65e9390b9cbebb010000008a473044022071fcfc013d7c056a0f2acb38db2d6adf0990e4224ddcefe517fbc9461a6f41580220486e0b1b5ffc017900aed37128914332144e29f6c2ab27ea843f2ef50e89283d014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff38a1a61a0d2658d33d8acca6bd05738c35dd6bcbead29b27b03ebb2a032c38f9010000008a47304402205121cb676e527185c9664eba46923029b028b026296ef50df61e47bf62704858022074d956ca3e62b0abb71bea1c65995804c7dbf534db63f2af48390d97aef078a7014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becfffffffff04933ac93da28948281ee858f2de7f9ce7144f291ed18cc632d6d37fd86960850000000894630430220d675fbe18fecfdafe4d3c1011dff7bba132f1e631b5de7d34d40e2becc1a0ece021f0687039ef3c6b09c020d584384ff1c6c360076a86fecf287424e14a767454c014104d88883e655d0804d21f4ce132cbfd55d01bb2970508fee5a96fb2c9d4100f4434c8d8bb5eeec3a0802e7cd6daf9ec0afaf29b5411aa49625de1ca541b0604cffffffffff11bc40a0c34d599aede7481e14334185fa76e198d8345978cdfd059bc0deb22d570000008a473044022023e7b9c856067d818540e760137b72cd6dcc9ff4f2bbce0552135bac66f6e2bd022054e6b6f25474f5aa95deb3bbe2a888dc456f78964051b2ab646cd9805080d465014104d88883e655d0804d21f4ce132cbfd55d01bb2970508fee5a96fb2c9d4100f4434c8d8bb5eeec3a0802e7cd6daf9ec0afaf29b5411aa49625de1ca541b0604cffffffffff309b69a095e42396e68e397f51a63455c6713164f9d676e45c16a1829a191b11010000008a473044022096c1780718c5bfed8a98ae8531cb51a5c6cdc4dfdfdb837b0368328826f66c9f02203c3eb9e3ec3344af7c46ea4c01d5e1b9764315b8fb49caddabfe2b23e9a86ad8014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff127739d3140f891e01775e986a727fe1160a3a8e8a9a8a750442dcedf67926bf010000008a4730440220dc0531fe10f3b9c568f01b39e8ab1d308a8c97ad1e594298ea92c98f8db7fb850220e6e5ef7827aa375865bc72852cc23d6bbe1620912dc8f4b1b6c8fbfdf560fe74014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff72b93f444ba757a77a5f97b0ccd0d85a50fde93d0480a7e804a47838c5c7a4c7010000008a4730440220e581c7a5e81637386b71f56c5a0659c0bb8e4f5fd87e76b4e46c285c02ba26a302206674ce3971b569a4defe4803ae0f21c0ec59ec643083ac6434e662b4aef04f83014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffffcba29f6e900ae7a9c14261b550e99f83a70d6835c74d84829b44ca9b75380d8c010000008a47304402203656ae2f1c1ac0e6feab6731bbdd5370c92bc4138a9ac509971234abc657c8b30220180fbfa73b662c9d1f4023c15d12199e41cbcd6cccfa40cdfb6d0d222b5988260141044d3272a6d7aad87f3555b1d331446d52fe1c80e4735a835b7e67c7ea144b750c2a095b173564a4a2e7a6d8be15e65a6836336d06219c6f97a4174be149b67a7efffffffff39dfcfe8c0467c26b61098b18415ec619b18b6f2c2ba846813008ad6d38432c000000008a4730440220ec6eea2acb774544c0dd2479414f4a0b1860fc53d7cbd2e4c38691cca8085c5f0220ea000db2e56886857d5bc86fa3c7ca2b0a3515d2f4a2ac18ea6f653c1fca90e3014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffffa8a20f88624da857d5b0fcd657694dd2bd968fd80a17331ac444515130bf08d7010000008a4730440220b3cc834fbe10f62866c989f323b8e72e40b0cf4efa02f4b096f6a1df211d52cd0220d0e6efabe23424d3f1c4d622b2ce100fee57cfc34b665a7c9e420a911451df980141044d3272a6d7aad87f3555b1d331446d52fe1c80e4735a835b7e67c7ea144b750c2a095b173564a4a2e7a6d8be15e65a6836336d06219c6f97a4174be149b67a7effffffff5657ee4a3297edf1c10ae9ded58651f1de24f015668db2c1c90fd3e8ee52d903010000008a47304402204420d59b017868b453fb1335e97a24ac833a499aa568c42cb35ac2430de4272f0220dedf4f18cb99a7ea80346eb4ef5f4b6932c688495800480917e9bde3f001eae0014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becfffffffff27f870ed701b1f5d362ca30aca6e7943c44a8f7b43d681022fbdb68893e8552010000008a47304402201e7a893574d070e21fd4659bd7a71f0023cbeca6b8ae8f8becf267ae325bb9040220852d7d88f64a33cb66175e2b37a5396a5f2d5adb38cef41a29fc19ec8f492fed014104cfd444c790b2d90a59aaf9ed73424501bd8585e7ab21c1c6529bac00ea0ab9f7cec827968d4f2b96bfdf1f54654358600fa8521fc8272ef689514f1f6a3b9d10ffffffffc5dc967af753ca8cdd87f0c448f1fd58cff891392ba4f3157b4d5f7a38af223c010000008a473044022046c229fb608a795c579fc4befbeed05630ddf08525299ef012614ecf9508db650220ecbfd3670dcddbe7c5ba87a1a4d86c520a1880e7ff6c3169df49af4ce188a47a014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff9d333fcdc6899e93770b7d36281d7a3f3cb9d55919105ab98bd67a5fe4540e0b500000008a47304402208d9879b0212d0bd76f20bf99474f4a1c728325a1ef80775bfb384227cc3f3c2c0220c0bfa71c201684f341b599916f6ccd89e26d1f37de47691d2d27762be9b3bae6014104d88883e655d0804d21f4ce132cbfd55d01bb2970508fee5a96fb2c9d4100f4434c8d8bb5eeec3a0802e7cd6daf9ec0afaf29b5411aa49625de1ca541b0604cffffffffff45ad937075a58a71e09551c299529f652ed57185d0f1fb0f15380a6d0119cc4d010000008a47304402204dcd8acd387a180e0856c356a1d1b8c7f9af93fa31ac437cdca22acdc7a2cec7022035c8da8a38c3446b7fb2e59521e7794f7d090f2072ab0f46d8bd7eaafd93e6b1014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffffe82fd799dc35693318d0381fb05644e8dd787f94c40665bdf67924f8af139948010000008a47304402204164dc89cf86212ad5c7c7c14a1264a8463dd9ac65157e3d2b5e94cae6e6f5f30220c0e901163f2f7004195c4a305f08b90562c0b0344de922775e05e836f84c06f7014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff33b99251fe7622de60723e9423104645567192bbd019eb62318a09181426c6cb010000008a4730440220d91cd1ce03276956533cf536c8f808aced9a0a838f2b52cbbcd5bd1ed10233ca022051ca5f9a7b016d57323fe11d98a0a3f977f52b06f98342302557726482df8e38014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff692de1cdc1b10e63e9321cc9221da485190e4585cbbe07fbc4faaea62676f705010000008a4730440220e8c16e9a1eeb78785cbb47e4f0847a26e1d4cf276130a16f0af23d53274df30802207e831e4fae7b6d5cd4e6c37bf32933201a4e25935493cd2d1911190bfc95a62b014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffffa8cd23f776f4faa539d45dfa0f378f1f3fb761c4472057bf6485a64545b642f9010000008a473044022073cc2172dd772bfde38e81400b7d30f850cd37b79871e3b571b547a72bbaac5602205edaecc6d04243052b318e3efd9255f62dcc1e65e47e5f21a6957ac751f9b42e014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff9f16ccc48d136ab371f3e0670893073e0a5e26ae58a5a353e9852601de847e19010000008a4730440220338e3809ac8dfb91ab717ae72dc41aaffef7e41bb19d685880b460894bb8845a0220d9b90cf3b88a01fdd50ec2ba06d7b4b2b0f8287158adca645dc4dbd1bf42fe8a014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffffbf3bc1b26ae6d06ded6cddcda41abd24e923e2029a0b0077dec0924c4432102f010000008a4730440220411f3dcc8ce8bda666fc54af5d604fd8a9929b82a9b69d3d0765ec74db34342e0220fb7546bd1501c8fc01a3ac5ef4fdea17808cb96993ed8dded9cb26b7670a3681014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff654b3009bdb61e7d276612e3eaac590f43e451a153ce8fc6d07d9530f867d51e010000008a473044022059cb3f779437a7c1ac66518894c127e99a26b5d0462176cf3862a6222b0860ff0220dda494b9c286219b695380472ae90c32362bc378f0970c76a1e1b6ffb0d2308d014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff4ef052c7a94a630602106f099fd37c67439b508bd59335ff7d0a1013bca5dbdf010000008a4730440220756c6017af7819200cbfa5f6917c07fd4f9e9cba811dc31531e4569ebfbf7346022021ca8b3fc6934e5cf29541ddf0c2308bf5263c9e0f85e71dead7392ebe31bbcd014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff2e93ef9f68687f531d9945a517b0e5993e54b871829bd505676108ff770c03f7010000008a47304402204a7a9b3e7db44afa6613bc65b968000bb36bd806740ac710f9d0e9a215827a6c02200184695eb70214f2b21427d05c3d9211b6a63885ea87117e7570b5d82c796503014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff438f8b32a858f2ed2a8ed79d3c4054975916c7d66dd817b09ec99340208618f2010000008a473044022066e2545f3b90e0fe438f23bc6dc92aa5e5f0333e5c9869490149d3f7f3446c640220fb5c3e70074349a095104a80774d45f7e578d1c5ebe9eb2ff193195d232adba5014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff1a20eea5b402115c970ea49054ef94a5c885bd55809abcc07afd5e6efabe5fa84f0000008a4730440220db0ae2977602b9337ac16233e857c5dff4490bab1f3db45811bee3876e08318b02200c8dfb7d35fe01aadff19cd055b95f14e83593e104ae8e439d724dfb3858861f014104d88883e655d0804d21f4ce132cbfd55d01bb2970508fee5a96fb2c9d4100f4434c8d8bb5eeec3a0802e7cd6daf9ec0afaf29b5411aa49625de1ca541b0604cffffffffffe6e046f56d0f99b8e047e5ade9b0851da87c6f960dc5f4431398baf5db104fba010000008a4730440220f24b91ad3aeb1867144fc9ffca655e0175f039e052d238c46090e5411d6b852e02205d548aa7b423b42af529442b45c10512c1ae86cac5fc81aa430d22b4c5db4338014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffffb88ea99d938a6fbf3a89da9f07409ab942c5b6bbef0e5da01b85d12cfe003a59010000008a4730440220eb9adcfdb755320c077fcc070fe4d4765c0e17226a2fd99386a12575708e50030220d3c66505cdd42717a103a77c95d9090f9d5194693f9d6949e81774397b5c3858014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becfffffffff282e4bbf4d381ad430ddf21ca0b97d0452f9480a636ca16cd295ffe22021a46010000008a4730440220d2338b6c44db0f7eb66d4ad4f7628cb05a3bdb567f02f4fc3d8524726879787d022089126f7e80b4fe4c77c593580347f2ca28c18fa1ff78b93c9ac257f583ce612d014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff6191948dca8110e828b3e7e361b27830ea72b2564315046b2e7f2d4d1e2b0d8f370000008a473044022051fda843b77a64402f5b97b61a4b3c5fda9c7b42c66d9731d34d1e60508f0e850220dfecec53d74479664cd307c8620ce75dfb0a1fb98a4bf2ab00a3393dfe3ac537014104d88883e655d0804d21f4ce132cbfd55d01bb2970508fee5a96fb2c9d4100f4434c8d8bb5eeec3a0802e7cd6daf9ec0afaf29b5411aa49625de1ca541b0604cfffffffffff50174a32cbfd6874f0f9f97c9604a7892107990836014ba803f55031514614e010000008a4730440220db04ea6365f43e196f4146e6302ebb07edc5defa94fc0a031a2d84d7d42ae9cc0220e657cad4c44a87387e7dfc5128f35a3c315750c4a31a9a9a83fdb47a705dab1c014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff160769f38db6965913981be8d10358bd480e57fed1054f6f95f8fbe1f76d7a22010000008a4730440220c3dc081517f481c774fc4e1aa1bebd3c1094e5c240962e39fd38dbc75d9b945e02202b3a88bad12d219bf14b16fc9b01fae965b26942616839b479ae136700e6f671014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff1b5c6e5dc1439e8f7ace95e459662b6bd86d3f3d6d8d55c78fb72400222d506a010000008a47304402201610c57cdde7ed9273f321d0271836083cb92b30a927c0cc0d4fd04e2ba70fb00220dfdbd287c101a1d3b0891c63c2149b30c21ba306f566e23e3da409cd6f42aa6e014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff5920bf56f438f693f356fe716e403963774c390a483fd1993f273eb1a236dda4010000008a4730440220d064c69cd352d6c0b54805778db69b8f1e7860031717dcae4627c30b3c6c0ea10220c31c8945a2b756948e3fa53ccdb4583d1a133aa91207e2258662c7ec793a500d014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff5235727c9284def3a8f8bad77f28ac9bf1c560c12caa8eebd93af9193240894d010000008a47304402201a81310aab5568e273c2071cc5dec9f2a3428006331882b3b6d1f0ced0c38e910220c543da6016efb26a43e1a58da4279e35906169f9ca878a93d9e6ec02dfb615dc014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffffcd24d7c5bdbb28f6c5f700f4d6440d3d02563451a093901749c929646928b188010000008a4730440220dc015ed14be6f315675c1afc35f05eabb9739a5ce19214162efc03b201526b620220c5c79bbb485ec2f782befbcaec21d6be445ef744cd5ea8465a17f46149c381bb014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff1343b7decc3b72a809310c6c8cf6934caa541a750773e2d9cb70d11e5bb8fb92400000008a4730440220e7b453f7118aabb468da2e07d4a1b180a7ce5badb1991b1ddec877b6a312658102200e1dfd2cf1d57170f411432bd33c8e79ad1a64bd21ec3889d59b7b188dbac43a014104d88883e655d0804d21f4ce132cbfd55d01bb2970508fee5a96fb2c9d4100f4434c8d8bb5eeec3a0802e7cd6daf9ec0afaf29b5411aa49625de1ca541b0604cffffffffffb457d6a8fb45b4cbe12c8ae5ce7f1d3982236e4daadd13c3e9e967e45034108d010000008a473044022013aec15eed9dd97f81ff069e5ec245d54ad8f0cff2cdb99c58ad60422ad05af502206ac75d1cd3b940ac20c0f60b6eab820a8d16a8bdcd6fbe41ed756c001126301a014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff5357a7831a7e59b50e48a08cabdc67d31925c317a65a62ae0006443136994d0c010000008a473044022088cea2e3e01ff7104ecd67a5eede1de96f788736248b08cbc7d613753d8f669b02207520334cf0088e898abede2a35977cdcf815794f0f5abe25f450b74ef0904729014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff949ec94409b76cd7461bf000ea2143ceab6f5bc1841ad6729babf163ec963cd0010000008a4730440220f65dcce9f1f35bac4b001a557135a988d1e3aa908709695d62047ad1ed86835802209ec7d1a78ad0a0043371990b1be8d489c842dfdfa5f9ae511d10a5e3babdf215014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff369d4015956e918173bbec62dd45fdb8e600c7d3af1d141500445e9248ea3670010000008a4730440220dcb29bc73a05251ce6a4f379d62bec009a14a76175a878d574886e31628a4a930220e11775c5ec7a2fb5ffbb2b58160d8a8b3983d54040b1bdd5e49652e75cbcfa39014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffffea665c970a2c92ed11fb3913f026d05f17147961978af5ad1355998bf198d08e010000008a47304402200f4113a61315fb0965717e2a54b6e223d7817294a7d0b60691abf01e0a2c6f6b0220e24573d2620b9ed574aa1947d01c8c15cf2b8e1a50fcc822b034f38756577d2c014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff4e67a4c7a97323461bfd3d73592d11d8434ea55495ffc631a732d0d941df7381010000008a47304402203124b29651dd0a54753562e0777cf77cab01888c3de5eba712bdada20f4cc4ee022099842f6348fcc9148222a037587621cb37bc6ae4334464913865551ef923c70b014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffffccf1a3f3fdc1574607db447fd5d689f05f404ba5a2254b32c4b4566ded826e6c010000008a4730440220e8f1f499ebd4bbe927eb8ae4d18e5da0dfbfd5a9718244443ba91c0bdc6a79b60220448b2a0f43f29eca13f740a2f33810e62296a4dd751d55a87d4b914d610b3b53014104e72bc2f6f00a5fa687cdca41cf844a93104a3a4894220b69342fddfb58ea1bb4c374bba365d6e75b5abe9d19cdad73943153af3e7129073e1829aed253d44becffffffff020003164e020000001976a914a4190b6f7a41698a75af17f2d01b37e8a934754888ac92199103000000001976a91402733677ac58e04c15c55af3147975680b9dce9688ac00000000";

    @Test
    public void validate() throws Exception {

        byte[] rawTransaction = HexUtils.parseHex(rawTransactionData);
        ByteBuffer buffer = ByteBuffer.wrap(rawTransaction);
        TransactionMessage transaction = TransactionMessage.read(buffer, Constants.VERSION_CURRENT);

        List<TransactionOutput> transactionOutputs = transaction.getTransactionOutputs();
        for (TransactionOutput transactionOutput:transactionOutputs) {
            byte[] pubkey = transactionOutput.getScriptPubKey();
            ScriptProgram scriptProgram = ScriptProgram.parse(pubkey);
            if (scriptProgram.isP2PKH()) {
                byte[] addressBytes =  scriptProgram.extractHashFromP2PKH();
                LegacyAddress legacyAddress = LegacyAddress.fromPubKeyHash(BitcoinNetwork.MAINNET, addressBytes);

                System.out.println(HexUtils.formatHex(transactionOutput.getScriptPubKey()));
                System.out.println(legacyAddress.stringFormat());
            }
        }

        System.out.println("txHash:"+transaction.getTransactionHash());
    }
}
